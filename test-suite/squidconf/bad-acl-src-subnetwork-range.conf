## Copyright (C) 1996-2023 The Squid Software Foundation and contributors
##
## Squid software is distributed under GPLv2+ license and includes
## contributions from numerous individuals and organizations.
## Please see the COPYING and CONTRIBUTORS files for details.
##

acl test1 src 127.0.0.1  127.0.0.0-127.0.0.255
acl test2 src 127.0.0.0-127.0.0.255  127.0.0.1
acl test3 src 127.0.0.0-127.0.0.128  127.0.0.128-127.0.0.255
acl test4 src 127.0.0.1-127.0.0.128 127.0.0.0-127.0.0.1 127.0.0.128-127.0.0.255

acl test5 dst 127.0.0.0-127.0.0.128/32  127.0.0.128-127.1.0.255

acl test6 dst 127.0.0.1-127.0.0.128  127.0.0.0-127.1.0.0/16
acl test7 dst 127.0.0.0-127.1.0.0/16 127.0.0.1-127.0.0.128

# official code parsing results:
#
# config:
# acl test1 src 127.0.0.1  127.0.0.0-127.0.0.255
# acl test2 src 127.0.0.0-127.0.0.255  127.0.0.1
# acl test3 src 127.0.0.0-127.0.0.128  127.0.0.128-127.0.0.255
# Processing: acl test1 src 127.0.0.1  127.0.0.0-127.0.0.255
# WARNING: (B) '127.0.0.1' is a subnetwork of (A) '127.0.0.0-127.0.0.255'
# WARNING: because of this '127.0.0.0-127.0.0.255' is ignored to keep splay tree searching predictable
# WARNING: You should probably remove '127.0.0.1' from the ACL named 'test1'
# Processing: acl test2 src 127.0.0.0-127.0.0.255  127.0.0.1
# WARNING: (A) '127.0.0.1' is a subnetwork of (B) '127.0.0.0-127.0.0.255'
# WARNING: because of this '127.0.0.1' is ignored to keep splay tree searching predictable
# WARNING: You should probably remove '127.0.0.1' from the ACL named 'test2'
# Processing: acl test3 src 127.0.0.0-127.0.0.128  127.0.0.128-127.0.0.255
# WARNING: (A) '127.0.0.128-127.0.0.255' is a subnetwork of (B) '127.0.0.0-127.0.0.128'
# WARNING: because of this '127.0.0.128-127.0.0.255' is ignored to keep splay tree searching predictable
# WARNING: You should probably remove '127.0.0.128-127.0.0.255' from the ACL named 'test3'
#
# official mgr:config
# acl test1 src 127.0.0.1
# acl test2 src 127.0.0.0-127.0.0.255
# acl test3 src 127.0.0.0-127.0.0.128
